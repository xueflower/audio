<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>文物介绍</title>
		<link rel="stylesheet" type="text/css" href="css/common.css"/>
		<link rel="stylesheet" type="text/css" href="css/style.css"/>
	</head>
	<body>
		<div class="container">
			<audio id="audio" src="audio/moon.mp3" controls loop></audio>
			<div class="false-control">
				<em class="audio-control"></em>
				<span class="time current-time">0:00</span>
				<!--<span class="time">/</span>
				<span class="time total-time">4:53</span>-->
			</div>
			<p class="title">文物名称</p>
			<div class="lrc">
				<ul id="lrc">
					<li>歌词加载中~</li>
				</ul>
			</div>
		</div>
	</body>
	<script src="js/resize.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/jquery-1.11.0.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/lrc.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript">
		//歌词动态交互
		var audio = $('#audio')[0];
		var num = -1;//时间计数
		var timer = "";//定时器
		var str = '';//当前播放时间
		timeArr=[];//文字介绍时间节点
		baseTop=168
		//(1)生成时间（总时间）
		var totalTime = audio.duration;
//		//(2)生成文字介绍
		var strLrc = '';
		for(var attr in lrc){
			strLrc+='<li class="lrc-item" data-time="'+attr+'">'+lrc[attr]+'</li>';
			timeArr.push(attr);
		}
		
		$('#lrc').html(strLrc);
		$('.audio-control').click(function(){
			if($(this).hasClass('active')){
				$(this).removeClass('active')
				clearInterval(timer)
				audio.pause()
			}else{
				audio.load();
				$(this).addClass('active')
				audio.play()
				timer = setInterval(function(){
					num+=1;
					if(num>=totalTime){
						num = -1;
						$(this).removeClass('active')
						clearInterval(timer)
						audio.pause()
					}else{
						if(Math.floor(num%60)>=10){
							str= Math.floor(num/60)+":"+Math.floor(num%60)
						}else{
							str= Math.floor(num/60)+":0"+Math.floor(num%60)
						};
						$('.current-time').html(str)
						for(var i=0;i<timeArr.length;i++){
							if(timeArr[i]==str){
								console.log(str)
								$('.lrc-item').removeClass('active');
								$('.lrc-item').eq(i).addClass('active');
								baseTop-=42
								$('#lrc').css({
									'top':baseTop/24+'rem'
								})
							}
						}
					}
				},1000)
			}
		})
	</script>
</html>
